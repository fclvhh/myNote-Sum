# é—²èŠå›è°ƒå‡½æ•°

å½¢å¼ä¸€ï¼š

```javascript
function fn1(){
	console.log("hello!")
}
function fn2(){
	fn1()
}
fn2() 
-------------------------------------------------
hello!

// åœ¨è°ƒç”¨XXXæ—¶ï¼Œåˆä¼šå»è°ƒç”¨YYYï¼ŒæŠŠyyyç§°ä¸ºå›è°ƒå‡½æ•°

```

å½¢å¼äºŒ:

ä¸Šè¿°ä»£ç çš„ä¸¥æ ¼æ¨¡å¼

```javascript
function fn1(){
	console.log("hello!")
}
function fn2(fn){
	fn()
}
fn2(fn1) 
-------------------------------------------------
hello!
// ä¸¥æ ¼æ¥è¯´,æ˜¯éœ€è¦ä¼ å‚,è¿™æ‰æ˜¯å‡½æ•°ä¸¥è°¨çš„è°ƒç”¨
// æŠŠfn1ä½œä¸ºå‚æ•°ä¼ ç»™fn2ä½¿ç”¨,å°±ç§°ä¸ºå›è°ƒ
// åªä¸è¿‡æ–¹å¼ä¸€ å†™èµ·æ¥æ›´ç®€å•,æ‰€ä»¥å°±ç”¨äº†æ–¹å¼ä¸€
```



## ä»€ä¹ˆæ˜¯å›è°ƒ?

åœ¨è°ƒç”¨fn1æ—¶å€™,å›è°ƒæ ˆé‡Œé¢è®°ä½fn1,è¿è¡Œfn1çš„ä»£ç ,å‘ç°è¦è°ƒç”¨fn2(),

æ­¤æ—¶éœ€è¦åˆ‡æ¢åˆ°fn2çš„è¿è¡Œç¯å¢ƒé‡Œé¢å»,ç„¶åè°ƒç”¨f'n2,å›è°ƒæ ˆä¼šè®°ä½fn2!è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹å°±æ˜¯å›è°ƒ!

**ğŸˆã€–æ ¸å¿ƒæ€»ç»“ã€—**

â’ˆå‡½æ•°Aä½œä¸ºå‚æ•° ä¼ å…¥åˆ°å‡½æ•°B

â’‰å‡½æ•°B ä½¿ç”¨äº†ä½œä¸ºå‚æ•°çš„å‡½æ•° A

æœ¬è´¨ : å¯¹ä¸€ä¸ªç°è±¡çš„æè¿°

ç°è±¡ :  ä½¿ç”¨å‚æ•°,å¯¼è‡´äº†å‡½æ•°ä¸Šä¸‹æ–‡çš„åˆ‡æ¢   =>å‚æ•°ä¸ºå‡½æ•°

**æŠŠè¿™ä¸ªç°è±¡æè¿°æˆå›è°ƒ!!!** 





## ä¸ºä»€ä¹ˆè¦æœ‰å›è°ƒ?

â‘ æ¥çœ‹ä¸€ä¸ªä¾‹å­

```javascript
// DOM readyä¹‹åæ‰§è¡Œ
$(document).ready(function(){
    // è·å–æ¨¡æ¿
    $.get(url, function(tpl){
        // è·å–æ•°æ®
        $.get(url2, function(data){
            // æ„å»º DOMString
            makeHtml(tpl, data, function(str){
                // æ’å…¥åˆ° DOM ä¸­
                $(obj).html(str);
            });
        });
    });
});
```

â‘¡ä»£ç åˆ†æ

â‘´ä¸Šè¿°ä»£ç åŠŸèƒ½: ç»„æˆä¸€ä¸ªDOM ,ç„¶åæ¸²æŸ“åˆ°htmlæ–‡æ¡£ä¸­å»

â‘µåŠŸèƒ½å®ç°:

â€‹		â’ˆå¾—åˆ°æ¨¡æ¿  html

â€‹		â’‰å¾—åˆ°data   

â€‹		â’Šæ‹¼æ¥

â€‹		â’‹æ¸²æŸ“

å…³ç³»:  åŸºæœ¬ä¸Šæ¯ä¸€æ­¥éƒ½ä¾èµ–ä¸Šä¸€æ­¥çš„ç»“æœ,æ¯ä¸€æ­¥éƒ½éœ€è¦æ—¶é—´

â‘¶ j s å•çº¿ç¨‹ 

1. ä¸Šè¿°åŠŸèƒ½å¤§ä½“éœ€è¦åˆ†å››æ­¥,æ¯ä¸€æ­¥éƒ½**éœ€è¦æ—¶é—´**æ¥å¤„ç†
2. j s ç”±äºæ˜¯å•çº¿ç¨‹çš„,æ‰€ä»¥**ä¸å¯ä»¥ç­‰å¾…**
3. äº§ç”Ÿäº†ä¸€ä¸ª çŸ›ç›¾ â€“- å¼‚æ­¥çš„é—®é¢˜
4. **ç‰¹æ®Šæœºåˆ¶** : jsæ˜¯ä¸ç­‰å¾…çš„,æ‰€æœ‰çš„å›è°ƒjså‡½æ•°éƒ½æ˜¯äº¤ç»™æµè§ˆå™¨ç›‘å¬å¼‚æ­¥æ“ä½œæ˜¯å¦å®Œæˆ,å†é€šçŸ¥jså¼•èµ·å›æ¥å®Œæˆå‡½æ•°ä»£ç  

â‘·çŸ›ç›¾çš„è§£å†³

åˆ©ç”¨å‡½æ•°å›è°ƒè®¾è®¡äº†ä¸€ç§å‡½æ•°   

```javascript
fn(a,b){
    // â‘ å…³äºaå‚æ•°çš„æ“ä½œ,å¾—åˆ°ç»“æœ
    a=a+1
    // â‘¡bæ˜¯å‡½æ•°ä½œä¸ºå‚æ•°è¢«è°ƒç”¨, ä½¿ç”¨åˆ°æ“ä½œ1çš„ç»“æœ
     b(a)
}
```

åˆ†æ:

1. é¦–å…ˆå®Œæˆè‡ªå·±çš„å¼‚æ­¥æ“ä½œ
2. é€šè¿‡å›è°ƒæŠŠ**å¼‚æ­¥æ“ä½œçš„ç»“æœ**ä¼ é€’ç»™å‡½æ•°å»æ‰§è¡Œç¬¬äºŒæ­¥çš„å¼‚æ­¥æ“ä½œ

é€šè¿‡get()è¿™ä¸ªå‡½æ•°çš„åµŒå¥—è°ƒç”¨å¯ä»¥å®ç°ä¸Šè¿°éœ€æ±‚

â‘¸ å›è°ƒå‡½æ•°è®¾è®¡çš„å¥½å¤„

ç»“æœä¼ é€’ : æ–¹ä¾¿çš„å°†å¼‚æ­¥æ“ä½œç»“æœ,ä¼ é€’ç»™ä¸‹ä¸€æ­¥çš„æ“ä½œ

å‰©ä¸‹çš„é—®é¢˜:

- åŒ¿åå‡½æ•°ç®€åŒ–ä»£ç ä¹¦å†™
  - ä¸ç”¨å…ˆå£°æ˜,å†ä½œä¸ºå‚æ•°
  - åŒ¿åå‡½æ•°å°±ç›´æ¥ä½œä¸ºå‚æ•°
- å¤šçº§åµŒå¥—å®ç°åŠŸèƒ½
- å¦‚æœåŠŸèƒ½è¿‡äºè´Ÿè´£èµ·æ€ä¹ˆåŠ????
- å¼‚æ­¥å›è°ƒå¤±è´¥äº†æ€ä¹ˆè¡¨ç¤º
  - è®¡ç®—æœºæ ¹æ® 01,è‚¯å®šçŸ¥é“æˆåŠŸè¿˜æ˜¯å¤±è´¥äº†
  - ä½†æ˜¯äººæ€ä¹ˆçŸ¥é“å‘¢?
  - æ˜¯å¼‚æ­¥æ“ä½œå¤ªè´Ÿè´£,éœ€è¦æ—¶é—´å¤ªå¤š?
  - è¿˜æ˜¯å¼‚æ­¥å¤±è´¥äº†å‘¢?

# å›è°ƒåœ°ç‹±

```javascript
// å½¢æ€1:
function è·å–ç”¨æˆ·ä¿¡æ¯ (fn){
    fn('riven')
}
function æ‰“å°ç”¨æˆ·ä¿¡æ¯(ç”¨æˆ·ä¿¡æ¯){
    console.log(ç”¨æˆ·ä¿¡æ¯)
}

è·å–ç”¨æˆ·ä¿¡æ¯(æ‰“å°ç”¨æˆ·ä¿¡æ¯)  

// å˜å½¢2:å‡½æ•°åŒ¿åè°ƒç”¨ B(A) ä¸­çš„Aå˜æˆåŒ¿åå‡½æ•°
// å¦‚æœå‡½æ•°Açš„ç›®çš„å°±æ˜¯ä¸ºäº†è¢«Bè°ƒç”¨,é‚£ä¹ˆAé‡‡ç”¨åŒ¿åå‡½æ•°æ›´é«˜æ•ˆ
function è·å–ç”¨æˆ·ä¿¡æ¯ (fn){
    fn('riven')
}
è·å–ç”¨æˆ·ä¿¡æ¯(function(ç”¨æˆ·ä¿¡æ¯){
    console.log(ç”¨æˆ·ä¿¡æ¯)
})  

//å˜å½¢3:å›è°ƒåœ°ç‹±
//B(A(C(D(E(F)))))  è¿™æ ·åµŒå¥—çš„æ–¹å¼å®åœ¨ä¼šå¾ˆå¤æ‚, å¦‚æœå†é‡‡ç”¨åŒ¿åå‡½æ•°ç®€åŒ–é‚£ç®€ç›´å°±æ˜¯åœ°ç‹±äº†å•Š
è·å–ç”¨æˆ·ä¿¡æ¯(function(ç”¨æˆ·ä¿¡æ¯){
    console.log(ç”¨æˆ·ä¿¡æ¯)
    ä¿å­˜ç”¨æˆ·ä¿¡æ¯(ç”¨æˆ·ä¿¡æ¯,function(){
        è·å–æ›´å¤š(xxx,function(){.....})
    })
})

```

å°ç»“:

â€‹		åŒ¿åå‡½æ•°ä½œä¸ºå‡½æ•°è°ƒç”¨çš„å‚æ•°,å¦‚æœå¤šå±‚åµŒå¥—,å°±ä¼šå¯¼è‡´ä»£ç æ— æ³•ç†è§£!

â€‹		å¹¶ä¸” ä»£ç ç»“æ„éš¾çœ‹ ,æ˜¯ä¸ª">â€ å½¢å¼ , æˆ‘ä»¬å¸Œæœ›æ˜¯é“¾å¼å½¢å¼

â€‹		è¿™å°±è¢«ç§°ä¸ºå›è°ƒåœ°ç‹±!

==åŒ¿åå›è°ƒçš„åµŒå¥—,æ˜¯">"å­—å½¢,ç»“æ„çœ‹ä¸æ¸…,å¯¼è‡´é€»è¾‘ç†ä¸æ¸…==

è§£å†³é—®é¢˜çš„æ ¸å¿ƒ===> **è®©ç»“æ„æ¸…æ™°**

**æ€è·¯: è®©å›è°ƒæŠŠè‡ªå·±çš„é€»è¾‘ä»£ç æ‰§è¡Œå®Œæ¯•,å†å»æ‰§è¡Œä¼ å…¥çš„å›è°ƒ**

â€‹			**ä¹Ÿå°±æ˜¯æ¸…æ™°å°†ä¸¤éƒ¨åˆ† åˆ†å‰²**

ä¸€ä¸ªPromiseå…ˆæ‰§è¡Œè‡ªå·±çš„é€»è¾‘ä»£ç , ç”¨resolveå’Œreject æ”¹å˜çŠ¶æ€, å¹¶ä¸”å¼¹å‡º æ“ä½œç»“æœ

çŠ¶æ€æ”¹å˜çš„Promiseä¼šè‡ªåŠ¨è°ƒç”¨è‡ªèº«çš„then()or catch() Api , æ·»åŠ å›è°ƒ,è¿”å›æ–°çš„Promiseå¯¹è±¡, å¹¶æ ¹æ®

ä¹‹å‰PromiseçŠ¶æ€,å†³å®šæ–°çš„Promise æ‰§è¡Œ å“ªä¸€ä¸ªå›è°ƒ

# è§£å†³å›è°ƒçš„é—®é¢˜

## å›è°ƒçš„å¸¸è§é—®é¢˜

1. ç”¨å›è°ƒåˆ¤æ–­å¼‚æ­¥æ“ä½œç»“æœçš„æˆåŠŸä¸å¦, æ–¹æ³•äº”èŠ±å…«é—¨ä¸å¥½å­¦ä¹ 
2. æˆ‘ä»¬å¸Œæœ›ç»Ÿä¸€æ ¼å¼,æ˜ç¡®åˆ¤æ–­å¼‚æ­¥æ“ä½œæ˜¯å¦æˆåŠŸ,ä¸ç”¨ä»˜å‡ºé¢å¤–æˆæœ¬
3. å›è°ƒåœ°ç‹±



## å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆ-Promise

Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„å¼‚æ­¥è§£å†³æ–¹æ¡ˆã€å›è°ƒå‡½æ•°ã€‘å’Œã€äº‹ä»¶ã€‘æ›´åˆç†ã€æ›´å¼ºå¤§ã€‚ç°å·²è¢« ES6 çº³å…¥è¿›è§„èŒƒä¸­ã€‚

å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼Œ`Promise`å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£(ä¹Ÿå°±æ˜¯A+è§„èŒƒ)ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚

- ç»Ÿä¸€äº†åˆ¤æ–­å¼‚æ­¥ç»“æœçš„æ ¼å¼
- éƒ¨åˆ†è§£å†³äº†å›è°ƒåœ°ç‹±

çœ‹ä¸€ä¸ªä¾‹å­

```javascript
fs.readFile('./l.txt', (error, content)=>{
      if(error){
      //å¤±ç•‹
      console.log("å‘œå‘œ")
}else{
        //æˆåŠŸ
     console.log("å“ˆå“ˆ")
     }
})
//é‡‡ç”¨promise ä¼˜åŒ–ä¸Šè¿°ä»£ç 
// æ‰§è¡Œå¼‚æ­¥æ“ä½œ,ç„¶åæ‰§è¡Œthen()  å¦‚æœå¼‚æ­¥æ“ä½œæˆåŠŸ,æ‰§è¡Œç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°,åä¹‹æ‰§è¡Œç¬¬äºŒä¸ªå‡½æ•°
var readFilePromise = new Promise (function(resolve,reject){
    readFile('./l.txt')
})
readFilePromise('./l.txt').then(function(){},function(){})
```



`promiss`è¯­æ³•

```javascript
// å¯¹äº å½¢å¦‚ A(B(C(D)))  ä¹Ÿå°±æ˜¯ A(fun(fun(fun()))) è¿™æ ·çš„å½¢å¼
//é‡‡ç”¨Promise ä¼˜åŒ–

A-Promise(function(){},function(){}) // è¿™æ˜¯B 
	.then(function(){},function(){}) // è¿™æ˜¯C
	.then(function(){},functioon(){}) // è¿™å°±æ˜¯D
//A-PromissæˆåŠŸçš„è¯,è°ƒç”¨ç¬¬ä¸€ä¸ªfn,å¦åˆ™è°ƒç”¨ç¬¬äºŒä¸ªfn,ç„¶åå†æ‰§è¡Œthen,thenæˆåŠŸè¯å°±æ‰§è¡Œç¬¬ä¸€ä¸ªfn,å¦åˆ™ç¬¬äºŒä¸ªfn
```

**å°ç»“:**

- é€šè¿‡then()è§£å†³å›è°ƒåœ°ç‹±
- é€šè¿‡ä¼ å…¥ä¸¤ä¸ªå‡½æ•°å‚æ•°,è§£å†³ä¸ç»Ÿä¸€çš„é—®é¢˜



## ğŸˆæ„Ÿæ€§è®¤çŸ¥

å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­[setTImeå›è°ƒåœ°ç‹±](http://js.jirengu.com/sawem/1)

[Promiseè§£å†³å›è°ƒåœ°ç‹±](http://js.jirengu.com/luduz/1)



æˆ‘ä»¬ä¸€èˆ¬æ˜¯å¦‚ä½•ä½¿ç”¨Promiseçš„å‘¢?

1. åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡   new Promise((resolve,reject)=>{ })
2. Promiseå‡½æ•°ä¼šä¼ å…¥ä¸€ä¸ªç®­å¤´å‡½æ•°ä½œä¸ºå‚æ•°,è¯¥ç®­å¤´å‡½æ•°æœ‰ä¸¤ä¸ªå›ºå®šçš„å‚æ•°   resolve å’Œ reject
  
   1. resolveå’Œreject å‚æ•°ä¹Ÿæ˜¯å‡½æ•°
3. resolve( ) å‡½æ•°è°ƒç”¨  ä¼šè½¬åˆ° then() ;  reject( error) å‡½æ•°è°ƒç”¨ä¼šè·³è½¬åˆ°catch( )
4. then(  ()={ }  )  

   1. thenå‡½æ•° ä¼šæŠŠä¸€ä¸ªç®­å¤´å‡½æ•°ä½œä¸ºå‚æ•°
   2. ç®­å¤´å‡½æ•°æ¯æ¬¡éƒ½è¦è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ 
   3. Promise å‡½æ•°çš„ç”¨æ³•ä¸€è‡´

5. catch((error)=>{ console.log(error) })

   1. thenå‡½æ•° ä¼šæŠŠä¸€ä¸ªç®­å¤´å‡½æ•°ä½œä¸ºå‚æ•°
   2. ä¸€èˆ¬ç®­å¤´å‡½æ•°ä¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°, ç„¶åæŠŠé”™è¯¯æ‰“å‡ºæ¥

   

   

# Promiseæ·±å…¥

## promiseé€»è¾‘

![](assets\Promise-5.jpg)

â‘´åˆ›å»ºPromiseå‡½æ•°

```javascript
  new Promise((resolve,reject)=>{
      å¼‚æ­¥æ“ä½œ
      åœ¨å¼‚æ­¥æ“ä½œçš„å›è°ƒå‡½æ•°ä»£ç ä¸­è°ƒç”¨resolve
  })
```

â‘µæ‰€è°“åŒ…è£¹

æŠŠå¼‚æ­¥æ“ä½œä»£ç ,æ”¾åˆ°Promiseçš„å›è°ƒå‡½æ•°ä¸­

â‘¶å¼‚æ­¥æ“ä½œçš„ä¸‰ç§çŠ¶æ€

1. ç­‰å¾…ç»“æœ
2. æˆåŠŸ
3. å¤±è´¥

â‘· rejectå’Œresolveå›è°ƒå‡½æ•°æ ¹æ®å¼‚æ­¥æ“ä½œçš„çŠ¶æ€æ‰§è¡Œ

1. è¿™éƒ¨åˆ†çš„é€»è¾‘Promiseå°è£…å¥½äº†,æˆ‘ä»¬ä¸ç”¨å†™if-else ,ç›´æ¥ç”¨å°±å¥½äº†
2. resolve()å›è°ƒè´Ÿè´£æŠŠå¼‚æ­¥ç»“æœå¸¦åˆ° then()å‡½æ•°
3. reject()å›è°ƒè´Ÿè´£æŠŠå¼‚æ­¥ç»“æœå¸¦åˆ°catch()å‡½æ•°

## ç»†èŠ‚æ·±å…¥

ãˆ å¦‚ä½•å¾—åˆ°Promiseå¯¹è±¡

1. å¾€Promise() é‡Œé¢å¡  executor

Promise( executor) æ„é€ å‡½æ•°   çš„ executor

```js
const promise = new Promise(executor)
```

executoræ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°

```js
(resolve,reject)=>{
    resolve()
}
```

ç®­å¤´å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°, è¿™ä¸¤ä¸ªå‚æ•°åˆéƒ½æ˜¯å›è°ƒå‡½æ•°

è‡ªå·±å†™åˆ¤æ–­é€»è¾‘,true å°±æ‰§è¡Œ resolveå›è°ƒ  , falseå°±æ‰§è¡Œrejectå›è°ƒ

2. Promise.resolve(executor)

```
promise.resolve((resolve,reject)=>{
    resolve()
})
```

ãˆ¡ Promiseå¯¹è±¡åŸå‹

æ–¹æ³•

1. then()

å½“Promiseçš„çŠ¶æ€å˜æˆfulfilledçŠ¶æ€, ä¹Ÿå°±æ˜¯åŒ…è£¹çš„å¼‚æ­¥æ“ä½œæˆåŠŸäº†

å˜æˆfulfilledçŠ¶æ€Promiseä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³•

**then()çš„ä½œç”¨:**

-  æ·»åŠ ä¸‹ä¸€æ­¥æ“ä½œ çš„æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒç»™ã€Œå½“å‰Promise å¯¹è±¡ã€,è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡
- æ–°çš„Promiseå¯¹è±¡ä¼šæ‰§è¡Œå…¶ä¸­ä¸€ä¸ªå›è°ƒ,å¹¶å°†å›è°ƒçš„ç»“æœ resolveæˆ–reject å‡ºå»

```js
promise.then(res=>{
    console.log("æˆåŠŸ!")
    res = res+1
    resolve(res)
})
```

2. catch()

æ·»åŠ ä¸€ä¸ªæ‹’ç»(rejection) å›è°ƒåˆ°å½“å‰ promise, è¿”å›ä¸€ä¸ªæ–°çš„promiseã€‚å½“è¿™ä¸ªå›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œæ–° promise å°†ä»¥å®ƒçš„è¿”å›å€¼æ¥resolveï¼Œå¦åˆ™å¦‚æœå½“å‰promise è¿›å…¥fulfilledçŠ¶æ€ï¼Œåˆ™ä»¥å½“å‰promiseçš„å®Œæˆç»“æœä½œä¸ºæ–°promiseçš„å®Œæˆç»“æœ.

3. finally()

æ·»åŠ ä¸€ä¸ªå›è°ƒç»™å½“å‰å¯¹è±¡,åœ¨å½“å‰å¯¹è±¡æ‰§è¡Œå®Œæ¯•æ—¶,è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡,

ä¸ç®¡è¿™ä¸ªè¿”å›çš„promiseçŠ¶æ€æ˜¯ä»€ä¹ˆ, éƒ½æ‰§è¡Œæ·»åŠ çš„å›è°ƒ

ãˆ¢æ‰§è¡Œç»†èŠ‚

rejectå’Œresolveçš„åŠŸèƒ½

1. è¿”å›å¼‚æ­¥æ“ä½œçš„ç»“æœ / è¿”å›å¼‚æ­¥é”™è¯¯çš„åŸå› 
2. æ”¹å˜å½“å‰çš„Promiseçš„çŠ¶æ€

| PromiseçŠ¶æ€ æ”¹å˜å‰                                | æ”¹å˜å                          |
| ------------------------------------------------- | ------------------------------- |
| *pending*: åˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥çŠ¶æ€ã€‚ | *fulfilled*: æ„å‘³ç€æ“ä½œæˆåŠŸå®Œæˆ |
| *pending*                                         | *rejected*: æ„å‘³ç€æ“ä½œå¤±è´¥ã€‚    |

then()å’Œcatch()çš„åŠŸèƒ½

1. æ·»åŠ å›è°ƒç»™å½“å‰çš„promiseå¯¹è±¡ 
2. æ ¹æ®resolveå’Œrejectç¡®å®šå½“å‰å¯¹è±¡çš„çŠ¶æ€ , è¿”å›åŒæ ·çš„çŠ¶æ€çš„å¯¹è±¡

fuifilledçŠ¶æ€çš„promiseå¯¹è±¡ä¼šæ‰§è¡Œæ·»åŠ çš„æˆåŠŸå›è°ƒ , rejectedçŠ¶æ€çš„ä¼šæ‰§è¡Œæ·»åŠ çš„å¤±è´¥å›è°ƒ



æƒ³è¦æŸä¸ªå‡½æ•°?æ‹¥æœ‰promiseåŠŸèƒ½ï¼Œåªéœ€è®©å…¶è¿”å›ä¸€ä¸ªpromiseå³å¯ã€‚

```js
requset(config){
    return new	Promise((reject,resolve)=>{
        const instance = axios.create(config)
        instance.then(res=>{
            console.log(res)
            resolve(res)
        })
    })
}
```

è¿™æ · requsetå‡½æ•°å°±å…·å¤‡äº†Promsieçš„åŠŸèƒ½!!!



## å…³äºthen()

thençš„å¦å¤–ä¸€ç§ç”¨æ³•

```js
then(()=>{},()=>{})
```

æœ‰ä¸¤ä¸ªå›è°ƒä½œä¸ºå‚æ•°, ç¬¬ä¸€ä¸ªå›è°ƒæ˜¯æˆåŠŸå›è°ƒ,ç¬¬äºŒä¸ªå›è°ƒæ˜¯å¤±è´¥å›è°ƒ, å–ä»£äº†catch()

```js
.then((res)=>{
    console.log(res)
}).catch(err=>{
    console.log(err)
})
```



è¿™æ ·çš„å¤„ç†æ–¹å¼å­˜åœ¨bug

çœ‹ä¸€ä¸ªä¾‹å­

```js
axios({
    url:"xxx"
}).then(s1,e1)  //ç¬¬ä¸€è´£ä»»äºº
.then(s2,e2)    // ç¬¬äºŒè´£ä»»äºº
.then(s3,e3)    // ç¬¬ä¸‰è´£ä»»äºº
```

ç¬¬ä¸€è´£ä»»äºº,ç»™axiosæ·»åŠ å›è°ƒ,å¹¶ä¸”ä¼šè¿”å›æ–°çš„Promiseå¯¹è±¡

ä¸ç®¡æ€ä¹ˆæ ·,axiosçš„çŠ¶æ€ä¸€å®šä¼šå‘ç”Ÿæ”¹å˜ , è¿™æ ·çš„æ–°çš„Promise,å°±å¿…ç„¶ä¼šæ‰§è¡Œæ·»åŠ çš„å›è°ƒä¸­çš„ä¸€ä¸ª

åŒç† , è¿™æ ·æ€è€ƒ,å°±å¯ä»¥ç†æ¸…æ¥šå…³ç³»äº†

----

---

---

---



# è‡ªå·±å†™Promise  

> å®åœ¨ç†è§£ä¸æ¥,æ²¡å…³ç³»,è®°ä½ä¸‹é¢çš„æ¨¡æ¿é€»è¾‘,å…ˆèƒŒä¸‹æ¥, ä¸€è¾¹ç”¨ , ä¸€è¾¹ç†è§£

```js
function ajax (){
    return new Promise((resolve,reject)=>{
        åšäº‹
        æˆåŠŸ:resolve(res) //æ”¹å˜å½“å‰PromiseçŠ¶æ€,å¹¶ä¸”è¿”å›res å¤„ç†ç»“æœ
        å¤±è´¥:reject(err)
    })
}
var promise = ajax()
promise.then(res=>{
    console.log(res)
}).catch(err=>{
    console.log(err)
})
or
promsie.then(successFn,errFn)
```



# await/async

Promiseè¿”å›çš„æ˜¯promiseå¯¹è±¡,å¹¶ä¸”ç»å¸¸å¼‚æ­¥çš„,

å¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨Promiseçš„æ•°æ®,å°±è¦ç­‰å¾…ä»–å®Œæˆ, è¿™æ ·å†™ä»£ç å°±å¾ˆéš¾å—

æ‰€ä»¥å‘æ˜äº†awaitè¯­æ³•,ç­‰å¾…Promiseå®Œæˆ

```javascript
let ç”¨æˆ·ä¿¡æ¯ = await è·å–ç”¨æˆ·ä¿¡æ¯()
console.log(ç”¨æˆ·ä¿¡æ¯)

å¦‚æœ promiseçš„ç»“æœé”™è¯¯ ,å°±ä¼šæ‰“å°é”™è¯¯æ¶ˆæ¯

```

## await

è§£å†³jså•çº¿ç¨‹çš„å¼‚æ­¥æŠ¥é”™  ==> **ä¸ç­‰å¾…æŠ¥é”™**

åœ¨å¼‚æ­¥æ“ä½œå‰é¢,åŠ ä¸Š await å…³é”®å­— , å‘Šè¯‰ jså¼•æ“, ç›¸å…³ä»£ç æš‚ä¸”ä¸æ‰§è¡Œ

è¿›ä¸€æ­¥åŒ…å« awaitè¯­å¥çš„å‡½æ•°ä¹Ÿéœ€è¦    **ä¸æ˜æ˜¾å¼‚æ­¥å‡½æ•°å£°æ˜**





## try  catch

```javascript
try{
	let ç”¨æˆ·ä¿¡æ¯ = await è·å–ç”¨æˆ·ä¿¡æ¯()
	console.log(ç”¨æˆ·ä¿¡æ¯)
}catch(error){
    console.log(error)
}
catch ç›¸å½“äº .then(undefined,function(){})	

```



## asyncä¾‹å­

```javascript
function fn (){
	let ç”¨æˆ·ä¿¡æ¯ = await è·å–ç”¨æˆ·ä¿¡æ¯()
	console.log(ç”¨æˆ·ä¿¡æ¯)
    return ç”¨æˆ·ä¿¡æ¯
}
var s = fn()
console.log(s)
// ä¸Šè¿°ä»£ç ä¼šæŠ¥é”™
// å› ä¸º æµè§ˆå™¨è®¤ä¸ºfn()æ˜¯åŒæ­¥å‡½æ•°,ä½†æ˜¯ä»–é‡Œé¢æœ‰awaitå¼‚æ­¥æ“ä½œ æ‰€ä»¥fnæ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°,æµè§ˆå™¨é‚£é‡Œç›´åˆ°å•Š,å¿…ç„¶æŠ¥é”™
// è§£å†³åŠæ³•: å¼‚æ­¥å‡½æ•°å£°æ˜
async function fn (){
	let ç”¨æˆ·ä¿¡æ¯ = await è·å–ç”¨æˆ·ä¿¡æ¯()
	console.log(ç”¨æˆ·ä¿¡æ¯)
    return ç”¨æˆ·ä¿¡æ¯
}
var s = await fn()
console.log(s)
```



# å¸¸ç”¨API

1. *Promise.all()*
2. [`Promise.prototype.allSettled()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled)
3. [`Promise.prototype.catch()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch)
4. [`Promise.prototype.finally()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/finally)
5. [`Promise.prototype.then()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/then)
6. [`Promise.race()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/race)
7. [`Promise.reject()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/reject)
8. [`Promise.resolve()`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve)



all ([promise1,promise2]).then() æ‰€æœ‰çš„promise éƒ½æˆåŠŸäº†æ‰è°ƒç”¨ then()

**race([promise1,promise2]).then()  ä»»æ„ä¸€ä¸ªpromiseæˆåŠŸäº†å°±è°ƒç”¨then()**

catch() <==> then(undefined,function(){})  æ²¡æœ‰æˆåŠŸå›è°ƒçš„then()

finally(function(){})   æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥,å›è°ƒå‡½æ•°éƒ½æ˜¯ä¸€ä¸ª(æˆåŠŸå’Œå¤±è´¥å›è°ƒåˆå¹¶)









